/* 858fcd6 */(function(){function f(){return function(){}}var q;function r(a,b,c){function d(){}var e,g,h=arguments.length,k;"function"!=typeof b?(e=function(){return a.apply(this,arguments)},g=0):(e=b,g=1);d.prototype=a.prototype;for(e.prototype=new d;++g<h;)for(k in arguments[g])e.prototype[k]=arguments[g][k];return e.prototype.constructor=e}function aa(a,b){var c=0,d=0;return function(){var e,g=a/b;++d<b?c+=g-(e=Math.floor(c+g)):d==b&&(e=Math.round(c+g));return e}}
var s={Zc:document.cookie.toQueryParams(/;\s*/),Ha:window.location.search.toQueryParams(),oc:"ontouchstart"in window||window.navigator.msMaxTouchPoints};function ba(a){var b;return function(){clearTimeout(b);b=setTimeout(a.curry.apply(a,arguments),150)}}
String.prototype.D=function(a){var b=arguments,c=0;return this.replace(/%(?:(\d+)\$)?(\+?)(0| |'.)?(-)?(\d*)(?:\.(\d+))?([bcdeEfosuxX%])/g,function(a,e,g,h,k,l,m,n){n=1<<"sbeoxdXfcEu".indexOf(n);if(1>n)return"%";a=b[e?e-1:c++];a=n&1?void 0==a?"":a+"":!0===a?1:(n&644?parseFloat(a):parseInt(a,10))||0;g=n&676&&0>a?"-":g;a=1<n&&0>a?n&346?a+4294967296:-a:a;if(n&256)return String.fromCharCode(a%n);m=n&10?n:n&80?16:n&645?m?m:n&1?a.length:6:0;a=n&1?a.slice(0,m):n&516?a.toExponential(m):n&90?a.toString(m):
a.toFixed(m);(e=[,g,,32<n?a.toUpperCase():a])["0"==h?2:k?4:0]=(h?h.slice(-1):" ").times(l-(g+a).length);return e.join("")})};
function ca(a,b){var c,d,e,g,h=[],k=[],l=a.replace(/<.*?>/g,function(a){return" ".times(a.length)}).toLowerCase();c=0;for(d=b.length;c<d;c++)if(e=0,g=b[c].length)for(;~(e=l.indexOf(b[c],e));)h.push(e),h.push(-(e+=g));if(0==h.length)return a+"";h.sort(function(a,b){var c=Math.abs(a),d=Math.abs(b);return c==d?a<b?1:0:c<d?-1:1});for(c=0;c<h.length-1;)0>h[c]?0>h[c+1]?h.splice(c,1):c++:0>h[c+1]?c++:h.splice(c+1,1);k.push(a.substring(0,h[0]));h.push(a.length);c=0;for(d=h.length-1;c<d;c+=2)k.push('<span class="highlight">'),
k.push(a.substring(h[c],-h[c+1])),k.push("</span>"),k.push(a.substring(-h[c+1],h[c+2]));return k.join("")}Math.F=function(a,b,c){return c>(a=b<a?a:b)?a:c};Math.truncate=function(a,b){return Math.round(a*Math.pow(10,b))/Math.pow(10,b)};function u(a,b){for(var c=a.concat(),d=c.length;d--;)c[d]*=b;return c}function da(a,b){var c=a.length-1;a.sort(b);b=b||function(a,b){return a===b?0:1};if(0<c)for(;c--;)0===b(a[c],a[c+1])&&a.splice(c,1);return a}Prototype.Browser.Uc=!!window.ActiveXObject&&!window.XMLHttpRequest;
Effect.Transitions.ad=function(a){return Math.pow(a,0.25)};
Element.addMethods({Wb:1,pb:2,Ub:3,Vb:4,Jb:function(a,b,c,d){a=$(a);var e=a.getOffsetParent(),g=a.offsetTop,h=g-e.offsetHeight+a.offsetHeight,k=e.offsetHeight<a.offsetHeight;if(e.scrollTop>a.offsetTop||e.scrollTop<h)b=k||b==Element.Wb||"undefined"==typeof b?g:b==Element.Ub?h:b==Element.pb?g-(e.offsetHeight-a.offsetHeight>>1):e.scrollTop<h?h:g,c?new Effect.Tween(e,e.scrollTop,b,Object.extend({duration:0.15,Qc:Effect.Transitions.sinoidal},d||{}),"scrollTop"):e.scrollTop=b;return a}});
var ea={onCreate:function(a){a.Rb=setTimeout(function(){if(!a._complete){a.cancel();var b=new Ajax.Response(a);(a.options.kd||a.options.gd||Prototype.emptyFunction)(b,b.headerJSON)}},0<a.options.timeout?1E3*a.options.timeout:a.fc)},onComplete:function(a){a.Rb&&clearTimeout(a.Rb)}},fa={fc:8E3,md:function(a){return new this.constructor(this.url,Object.extend(this.options,a||{}))},cancel:function(){if(!this._complete){this.transport.onreadystatechange=Prototype.emptyFunction;this.transport.abort();var a=
new Ajax.Response(this);try{(this.options.dd||Prototype.emptyFunction)(a,a.headerJSON),Ajax.Responders.dispatch("onComplete",this,a,a.headerJSON)}catch(b){this.dispatchException(b)}}}},ga=function(){function a(a){var b=a.url||"",c=a.method,d=a.options.ld||{},e=b.indexOf("?");a=-1==e?b:b.substring(0,e);b=Object.toQueryString(Object.extend((-1==e?"":b.substring(e)).toQueryParams(),"get"==c?d:{})).split("&").sort().uniq(!0).join("&");c=Object.toQueryString("get"==c?{}:Object.extend({Vc:c},d)).split("&").sort().uniq(!0).join("&");
return[a,b,c].join("|")}var b=Ajax.Request.prototype.request,c=Ajax.Request.prototype.respondToReadyState,d,e;d={};e=0;setInterval(function(){2E3<e&&(d={},e=0)},18E4);return{ib:!1,Ib:!1,request:function(c){var e;this.url=c;this.method=this.options.method;if(this.options.ib&&!this.options.Ib&&a(this)in d)try{var k;var l=a(this);l in d?(d[l].lc++,d[l].qc=new Date,k=d[l].transport):k=this.transport;this.transport=k;e=new Ajax.Response(this);this.options.xc&&this.options.xc(e);Ajax.Responders.dispatch("onCreate",
this,e);this.respondToReadyState(4)}catch(m){this.dispatchException(m)}else b.call(this,c)},respondToReadyState:function(b){c.call(this,b);!(this.options.ib&&this._complete&&this.success())||!this.options.Ib&&a(this)in d||(b=this.transport.responseText.length,e++,d[a(this)]={transport:this.transport,lc:0,$c:new Date,qc:new Date,Yc:b})}}}();Ajax.Request.addMethods(ga);Ajax.Request.addMethods(fa);s.Ra=function(a,b){for(var c in b)switch(c){case "id":a.id=b[c];break;case "title":a.title=b[c];break;case "description":a.description=b[c];break;case "source":a.source=b[c];break;case "bgColor":a.bgColor=b[c];break;case "power":a.bb=b[c];break;case "url":a.url=b[c];break;case "levels":a.i=b[c];break;case "series":a.Ka=b[c];break;case "name":a.name=b[c];break;case "plane":a.oa=b[c];break;case "slides":a.t=b[c];break;default:a[c]=b[c]}return a};function v(a){function b(b){var c=a[b];return function(a){return c(a,0|(a.shiftKey&&w.sa)|(a.ctrlKey&&w.ra)|(a.altKey&&w.Tb)|(a.metaKey&&w.ob))}}var c,d,e={};for(c in a)d=b(c),c.replace(/^.*:\D+/,"").split(/\D+/).filter(Number).each(function(a){e[a]=d});this.keys=e}function ha(a){this.Ca=[];for(var b=0;b<arguments.length;b++)this.Ca.unshift(arguments[b])}
var w=new function(){function a(a){for(var d=a.keyCode,e=(b[b.length-1]||new ha).Ca,g=0,h=e?e.length:0;g<h;){if(d in e[g].keys){e[g].keys[d](a);break}g++}}var b=[];this.pc=!0;this.cb=function(a){b.push(a)};this.Gb=function(){var a,d=this.pc?1:0;do a=b.pop();while(b.length>d&&void 0!=a)};this.start=function(){Event.observe(window,"keydown",a);return this};this.stop=function(){Event.stopObserving(window,"keydown",a);return this};this.clear=function(){b=[];return this}};w.sa=1;w.ra=2;w.Tb=4;w.ob=8;function x(a){s.Ra(this,a||{});"string"==typeof this.url&&(this.url=Prototype.K.curry(this.url));this.i.sort(this.rc)}q=x.prototype;q.bb=1;q.title="";q.description="";q.source="";q.V="";q.bgColor="transparent";q.url=function(a,b,c,d){return[this.V,"?s=",this.id,"&x=",a,"&y=",b,"&z=",c,"&i=",d].join("")};q.rc=function(a,b){return b[0]-a[0]};q.l=function(a){a=a||0;return[this.i[a][0]/2,this.i[a][1]/2]};q.R=function(a){return y(this,a=a||0)?this.bb*this.B(a):void 0};
q.B=function(a,b){return this.i[a][0]/this.i[b||0][0]};function ia(a,b,c){return[b[0]*a.B(c),b[1]*a.B(c)]}function z(a,b,c){for(var d=0,e=a.i.length-1;d<e&&!(a.i[d][0]<b&&a.i[d][1]<c);d++);return d}function ja(a,b,c){b*=c;c=[];a=a.i;for(var d=a.length;d--;)c[d]=Math.abs(b-a[d][0]*a[d][0]);return c.indexOf(c.length?Math.min.apply(null,c):void 0)}function y(a,b){return 0<=b&&b==Math.floor(b)&&b<a.i.length}
function ka(a,b){for(var c=Infinity,d,e,g=0;g<a.i.length;g++)(e=Math.abs(a.R(g)-b))<c&&(c=e,d=g);return d};function A(){this.n={};this.A={move:[],grab:[],drop:[],zoom:[],load:[],tile:[],attach:[],unload:[],destroy:[],detach:[],resize:[[this,this.Hc]],down:[[this,this.Xa],[this,this.focus]],click:[],dblclick:[[this,this.M]]};this.zb=[];this.ta=this.Bb.bind(this);this.rb=this.hc.bindAsEventListener(this);this.ta=this.Bb.bindAsEventListener(this);this.qb=this.gc.bindAsEventListener(this);this.tb=this.Fa.bindAsEventListener(this);this.sb=this.yc.bindAsEventListener(this);this.Zb=this.qa.bind(this);this.ga=
this.J.bind(this);this.fa=this.N.bind(this);this.ha=this.Y.bind(this);this.$b=this.Pc.curry(this);this.Qb=setInterval(this.mc.bind(this),this.Oc);this.name="Viewer"+D.length;this.id=D.push(this)-1}var D=[],E=null;q=A.prototype;q.wa=50;q.f="vsViewer";q.W=1;q.Ob=1;q.Pb=2;q.Nc=8;q.Oc=8E3;q.Qb=0;q.Ab="";q.w=!1;q.Ya=0;q.Za=0;q.offsetX=0;q.offsetY=0;q.j=0;q.o=0;q.Oa=0;q.Ma=0;q.ca=0;q.Na=0;q.eb=0;q.fb=0;q.kb=0;q.lb=0;q.mb=0;q.nb=0;q.d=Number.POSITIVE_INFINITY;
function la(a,b){var c=a.b?[a.b,a.d,a.l()]:null;a.e&&a.detach();a.e=$(b);na(a).q("attach",void 0,a.e);c&&a.load.apply(a,c);return a}q.detach=function(a){this.e&&(this.b&&this.hb(),this.q("detach",a,this.e),this.e=null);return this};
q.load=function(a,b,c,d,e){if(!this.e)return this;this.loaded()&&this.hb();this.b=a;this.da=[];this.La=[];this.d=Number.POSITIVE_INFINITY;oa(this,b)||oa(this,z(a,this.j,this.o));this.element=this.createElement();this.offsetX=this.offsetY=0;c=c?d?ia(a,c,this.d):c:a.l(this.d);pa(this,c);this.e.observe("mousedown",this.tb).observe("dblclick",this.sb).style.backgroundColor=a.bgColor;return qa(this.q("load",e,a,b,c).qa())};
q.hb=function(a){this.b&&(this.q("unload",a),this.e&&(this.e.stopObserving("dblclick",this.sb).stopObserving("mousedown",this.tb),this.element&&this.e.removeChild(this.element),this.e.style.backgroundColor=x.prototype.bgColor),this.b=this.element=null);return this};q.loaded=function(){return!!this.e&&!!this.b};q.u=function(a,b){try{new a(this,b||{})}catch(c){console.error("Error creating widget: %s".D(c.message))}finally{return this}};q.focus=function(){return E=this};
q.Hc=function(){na(this).loaded()&&this.qa()};q.refresh=function(){var a=this.createElement();qa(this,a);this.element&&this.e.removeChild(this.element);this.element=a;return this.qa()};q.createElement=function(){var a=(new Element("DIV")).addClassName(this.f);this.Lb();a.style.width=parseInt(this.$,10)+"px";a.style.height=parseInt(this.Z,10)+"px";a.style.left=(this.P=this.j-this.$>>1)+"px";a.style.top=(this.Q=this.o-this.Z>>1)+"px";this.e.appendChild(a);return a};
function qa(a,b){for(var c,d=document.createDocumentFragment(),e=a.La,g=e.length,h=a.offsetX-a.P,k=a.offsetY-a.Q,l=-h,m=-k,n=a.$-h,t=a.Z-k;g--;)c=e[g],c[1]<n&&c[2]<t&&c[3]>l&&c[4]>m&&(c[0].style.left=c[1]+h+"px",c[0].style.top=c[2]+k+"px",d.appendChild(c[0]));(b||a.element).appendChild(d);return a}q.Lb=function(){this.$=(2*this.W+1)*screen.width;this.Z=(2*this.W+1)*screen.height};
q.ub=function(a,b,c,d,e,g){var h=a.style;if(void 0==b&&isNaN(b=parseInt(h.left,10))||void 0==c&&isNaN(c=parseInt(h.top,10)))return this;this.La.push([a,b,c,(void 0==d?parseInt(h.width,10)||1:d)+b,(void 0==e?parseInt(h.height,10)||1:e)+c]);g&&(d=this.offsetX-this.P,e=this.offsetY-this.Q,b>-d&&c>-e&&b<this.$-d&&c<this.Z-e&&(h.left=b+d+"px",h.top=c+e+"px",this.element.appendChild(a)));return this};
q.Fa=function(a){a.isLeftClick()&&(a.stop(),document.observe("mouseup",this.rb),this.q("down",null,a,ra(this,a)))};q.yc=function(a){a.stop();this.q("dblclick",null,a,ra(this,a))};q.Xa=function(a){this.Ya=a.screenX;this.Za=a.screenY;document.observe("mousemove",this.ta).observe("mousemove",this.qb)};q.Bb=function(a){document.stopObserving("mousemove",this.ta);this.q("grab",this,a,ra(this,a));this.w=!0};
q.hc=function(a){document.stopObserving("mousemove",this.ta).stopObserving("mousemove",this.qb).stopObserving("mouseup",this.rb);this.w?this.refresh().q("drop").w=!1:this.q("click",this,a,ra(this,a))};
q.gc=function(a){Event.stop(a);var b,c,d=a.screenX;a=a.screenY;var e=[];c=this.element.style;var g=this.A.move,h=g.length,k=this.P,l=this.Q;b=k-this.offsetX;var m=l-this.offsetY;c.left=(this.P=b=Math.F(k+this.W*(d-this.Ya),this.kb+b,this.lb+b))+"px";c.top=(this.Q=c=Math.F(l+this.W*(a-this.Za),this.mb+m,this.nb+m))+"px";this.Ya=d;this.Za=a;this.offsetX+=e[0]=b-k;this.offsetY+=e[1]=c-l;for(sa(this)&&ta(this,0);h--;)g[h][1].call(g[h][0],e,this)};
function sa(a){var b=ua(a,a.offsetX,a.offsetY,a.j,a.o,0),c=a.ca;return b.Ia<Math.floor(a.eb/c)||b.Ja>Math.floor(a.fb/c)||b.xa<a.eb%c||b.ya>a.fb%c}q.M=function(a,b){F(this,this.d+(a.shiftKey?1:-1),b)};function ra(a,b){var c=b.element().cumulativeOffset().relativeTo(a.e.cumulativeOffset());return[c[0]+(b.offsetX||b.layerX)-a.offsetX,c[1]+(b.offsetY||b.layerY)-a.offsetY]}
function F(a,b,c,d){var e=a.d,g=va(a),h=a.Oa,k=a.Ma,l=a.width,m=a.height,n=a.ca-1,t=a.Na-1;c=c instanceof Array?c:a.l();if(oa(a,b)){var p=a.da,B=p.length,C=a.b.B(b=a.d,e),G=Math.round(C*h),H=Math.round(C*k),I=G*g.xa,S=H*g.Ia,h=Math.round(C*(l%h||h)),k=Math.round(C*(m%k||k)),m=document.createElement("DIV");c=pa(a,u(c,C));m.style.position="absolute";m.style.zIndex=0;if(e>b)for(;B--;)e=p[B],e.src&&(m.appendChild(e),e.width=e.T==n?h:G,e.height=e.U==t?k:H,e.style.left=G*e.T-I+"px",e.style.top=H*e.U-S+
"px");a.La=[];a.da=[];a.e.removeChild(a.element);a.element=a.createElement();qa(a.q("zoom",d,b).q("move",a,c).ub(m,I,S,G*(1+g.ya)-I,H*(1+g.Ja)-S));setTimeout(a.Zb,0)}return a}q.Pa=function(a,b){return F(this,this.d-1,a,b)};q.Qa=function(a,b){return F(this,this.d+1,a,b)};
q.qa=function(){var a=ta,b,c,d,e=this.d,g=this.offsetX-this.P,h=this.offsetY-this.Q;d=this.da;var k=d.length,l=this.Oa,m=this.Ma,n=[],t=[],p;b=va(this);var B=b.xa,C=b.Ia,G=b.ya,H=b.Ja,I=this.ca,S=I-1,Va=this.Na-1,Wa=this.width%l||l,Xa=this.height%m||m,T=document.createElement("IMG"),ma=document.createDocumentFragment();T.style.position="absolute";T.style.display="none";T.style.zIndex=1;for(T.alt="";k--;)p=d[k],b=p.U,c=p.T,b<C||b>H||c<B||c>G||(n[b*I+c]=!0,t.push(ma.appendChild(p)),p.style.left=l*c+
g+"px",p.style.top=m*b+h+"px");for(b=C;b<=H;++b)for(c=B;c<=G;++c)d=b*I+c,n[d]||(p=T.cloneNode(!1),p.width=c==S?Wa:l,p.height=b==Va?Xa:m,p.style.left=l*c+g+"px",p.style.top=m*b+h+"px",p.onload=this.$b,p.U=b,p.T=c,p.Xb=this.b.url(c,b,e,d),t.push(ma.appendChild(p)));this.element.appendChild(ma);this.da=t;return a(this,this.Ob)};
function ta(a,b,c){for(var d=a.da,e=d.length,g=[],h,k=ua(a,a.offsetX,a.offsetY,a.j,a.o,0<b?b:0),l=k.xa,m=k.Ia,n=k.ya,k=k.Ja,t=a.ca,p=m+(k-m)/2,B=l+(n-l)/2;e--;)(h=d[e]).src||h.U<m||h.U>k||h.T<l||h.T>n||g.push(h);g.sort(function(a,b){var c=b.U-p,d=b.T-B,e=a.U-p,g=a.T-B;return c*c+d*d-e*e-g*g});for(e=0<c?Math.min(c,g.length):g.length;e--;)g[e].src=g[e].Xb;b||(a.eb=m*t+l,a.fb=k*t+n);return a}q.Pc=function(a){this.style.display="block";a.q("tile");this.onload=null};
q.mc=function(){if(!this.w&&this.loaded()&&this.Pb){for(var a=this.da,b=a.length;b--;)if(a[b].src&&!a[b].complete)return;ta(this,this.Ob+this.Pb,this.Nc)}};
function oa(a,b){var c;c=a.d;var d=a.loaded()&&c!=(b=b==Number.POSITIVE_INFINITY?a.b.i.length-1:parseInt(b,10))&&y(a.b,b);d&&(y(a.b,c)&&(c=u(a.l(),a.b.B(b,c)),a.offsetX=Math.round(a.j/2-c[0]),a.offsetY=Math.round(a.o/2-c[1])),c=a.b.i[b],a.ca=Math.ceil((a.width=c[0])/(a.Oa=c[2])),a.Na=Math.ceil((a.height=c[1])/(a.Ma=c[3])),a.kb=a.wa-c[0],a.mb=a.wa-c[1],a.d=b);return d}
q.moveTo=function(a,b){var c=this.element.style,d=wa(this,a);c.left=(this.P+=d[0])+"px";c.top=(this.Q+=d[1])+"px";this.q("move",b,d);sa(this)&&(this.w?this.qa():this.refresh());return d};q.O=function(a,b){return this.moveTo([this.j/2-a[0],this.o/2-a[1]],b)};
function xa(a,b,c){function d(a){e.cancel();g.e.stopObserving("mousedown",arguments.callee);g.Fa(a);g=e=null}var e,g=a,h=[a.offsetX,a.offsetY],k=wa(a,b);a.offsetX=h[0];a.offsetY=h[1];g.e.observe("mousedown",d);e=new Effect.Tween(a,0,1,Object.extend({Qc:Effect.Transitions.sinoidal,Xc:function(){g.w=!0},Wc:function(){g.e.stopObserving("mousedown",d);g.w=!1;g.refresh();g=e=null}},{}),function(a){this.moveTo([h[0]+k[0]*a,h[1]+k[1]*a],c)})}
function wa(a,b){var c=a.offsetX,d=a.offsetY;return[(a.offsetX=Math.F(Math.round(b[0]),a.kb,a.lb))-c,(a.offsetY=Math.F(Math.round(b[1]),a.mb,a.nb))-d]}function pa(a,b){return wa(a,[a.j/2-b[0],a.o/2-b[1]])}function na(a){if(a.e){var b=a.e.getDimensions();a.j=b.width;a.o=b.height;a.lb=b.width-a.wa;a.nb=b.height-a.wa}return a}q.l=function(a){if(this.loaded())return[Math.round((this.j/2-this.offsetX)*(a?this.b.B(0,this.d):1)),Math.round((this.o/2-this.offsetY)*(a?this.b.B(0,this.d):1))]};
function ua(a,b,c,d,e,g){var h=a.Oa,k=a.Ma,l=a.ca-1;a=a.Na-1;return{xa:Math.F(Math.floor(-b/h)-g,0,l),Ia:Math.F(Math.floor(-c/k)-g,0,a),ya:Math.F(Math.floor((d-b)/h)+g,0,l),Ja:Math.F(Math.floor((e-c)/k)+g,0,a)}}function va(a){return ua(a,a.offsetX-a.P,a.offsetY-a.Q,a.$,a.Z,0)}q.B=function(){return this.b?this.b.B(this.d):void 0};q.R=function(){return this.b?this.b.R(this.d):void 0};function J(a,b,c,d){c=[c,d];a.A[b]?a.A[b].push(c):a.A[b]=[c];return a}
q.q=function(a,b,c){var d=this.zb,e=0==d.length,g=Array.prototype.slice.call(arguments,2),h=this.A[a],k=0,l;if(h){l=h.length;if(b)for(;k<l;k++)h[k][0]==b||d.push([h[k],g]);else for(;k<l;k++)d.push([h[k],g]);if(e){for(k=0;k<d.length;k++)try{d[k][0][1].apply(d[k][0][0],d[k][1])}catch(m){console.error("[vs.Viewer] doEvent('%s'): %s".D(a,m.message))}this.zb=[]}}return this};
q.ea=function(a,b,c){var d,e;if("object"==typeof arguments[0])for(e in this.A)for(d=this.A[e].length;d--;)this.A[e][d][0]==arguments[0]&&this.A[e].splice(d,1);else if((e=this.A[a])&&(d=e.length)&&1!=arguments.length)if(2==arguments.length)for(;d--;)e[d][0]==b&&e.splice(d,1);else for(;d--;)e[d][0]==b&&e[d][1]==c&&e.splice(d,1);return this};q.L=function(a){this.request&&this.request.cancel();clearInterval(this.Qb);this.q("destroy",a).detach();for(var b in this)delete this[b];E==this&&(E=null);D=D.without(this)};
function ya(a,b,c,d,e,g){a.request&&a.request.cancel();a.request=new Ajax.Request(a.Ab,Object.extend({method:"get",parameters:{s:b},onSuccess:a.ga,onFailure:a.fa,onTimeout:a.ha,onException:function(a,b){console.error("Ajax exception: %s",b.message)},ib:!0,Lc:c,Kc:d,ac:e,nc:null},g||{}))}q.J=function(a){var b,c=a.request.options;try{b=new x(eval("("+a.responseText+")"))}catch(d){(c.fd||Prototype.emptyFunction)(a.request,d)}this.load(b,c.Lc,c.Kc,c.ac,c.nc)};q.N=f();q.Y=f();
var za=new v({"-: 45 109 189 231":function(a,b){Prototype.Browser.Opera&&a.stop();var c=E;if(c&&!c.w)if(b==w.sa){var d=c.d,e=z(c.b,c.j,c.o),g=c.b.l(d);F(c,e,g);c.d==d&&c.O(g)}else b||c.Qa()},"+: 43 61 107 187":function(a,b){Prototype.Browser.Opera&&a.stop();var c=E;c&&!c.w&&(b==w.sa?F(c,0):b||c.Pa())}}),Aa=new ha(za);w.cb(Aa);function Ba(){for(var a,b=D,c=b.length;c--;)(a=b[c]).e&&a.q("resize",null,a.e.getDimensions())};function K(a,b){var c,d=Ca;s.Ra(this,b);this.a=a;this.p&&(a.n[this.p]=this);this.G=[];this.g&&this.g();for(c in d)c in this&&"function"==typeof this[c]&&J(a,d[c],this,this[c]);this.L&&J(this.a,"destroy",this,this.L);for(d=this.G.length;d--;)c=this.G[d],Event.observe(c[0],c[1],c[2]);this.H&&a.e&&this.H(a.e);this.k&&a.loaded()&&this.k(a.b,a.d,a.l())}
K.prototype.L=function(){for(var a,b=this.G.length;b--;)a=this.G[b],Event.stopObserving(a[0],a[1],a[2]);this.a.ea(this);this.ma&&this.ma();this.p&&this.a.n[this.p]&&delete this.a.n[this.p];delete this.a};var Ca=Object.clone({H:"attach",ab:"click",ed:"dblclick",Ea:"detach",Eb:"drop",zc:"grab",k:"load",hd:"move",Ec:"resize",jd:"tile",S:"unload",X:"zoom"});delete Ca.ma;
var L=r(K,{element:null,e:null,f:"",r:!1,C:function(a){a.stopPropagation?a.stopPropagation():a.cancelBubble=!0},show:function(){this.r&&this.toggle();return this},hide:function(){this.r||this.toggle();return this},toggle:function(){this.r=!this.r;this.element.toggleClassName("minimized");return this},H:function(a){this.r&&this.hide();$(this.e||a).appendChild(this.element)},Ea:function(){this.element.parentNode&&this.element.parentNode.removeChild(this.element)},k:function(){this.visible&&this.element.show()},
S:function(){this.visible&&this.element.hide()},L:function(){K.prototype.L.call(this);L.prototype.Ea.call(this);this.element=null}});function Da(a){function b(a){function b(){l=a.offsetX;m=a.offsetY;n=a.d;a.loaded()&&(t=a.b.R(n))}var l,m,n,t;b();c[g]=J(J(J(J(J(a,"move",e,function(){if(this.move)for(var b=g,e=this.Ga?1/t:1,k=this.tc?e*(a.offsetX-l):0,e=this.uc?e*(a.offsetY-m):0;b--;)c[b]==a||d[b].move(k,e)}),"zoom",e,function(){var b=g,e;if(this.M){for(e=this.Ga?a.b.R(a.d):a.d-n;b--;)c[b]==a||d[b].M(e);b=g}for(;b--;)d[b].Mb()}),"drop",e,function(){for(var a=g;a--;)c[a].w=!1}),"grab",e,function(){for(var a=g;a--;)c[a].w=!0}),"load",
e,b);d[g++]={move:function(b,c){a.moveTo(e.Ga?[t*b+l,t*c+m]:[b+l,c+m],e)},M:function(b){F(a,e.Ga?ka(a.b,b):n+b,null,e)},Ha:function(){console.log("%s: %d %d %d (%d)",a.name,l,m,n,t)},Mb:b}}var c=[],d=[],e=this,g=0;this.add=function(a){for(var e=d.length;e--;)d[e].Mb();$A(arguments).flatten().each(function(a){c.include(a)||b(a)})};this.remove=function(a){$A(arguments).flatten().each(function(a){a=c.indexOf(a);-1!=a&&(c[a].ea(e),c.splice(a,1),d.splice(a,1),g--)})};this.Pa=function(){for(var a=g;a--;)c[a].Pa(null,
this)};this.Qa=function(){for(var a=g;a--;)c[a].Qa(null,this)};this.L=function(){this.remove.apply(this,c);d.length=0;delete this.remove;delete this.add;e=null};this.Ha=function(){d.invoke("query")};this.add.apply(this,arguments)}q=Da.prototype;q.move=!0;q.tc=!0;q.uc=!0;q.M=!0;q.Ga=!0;function M(a,b){var c;if(b.id)c="vs%d_%d".D(a.id,b.id);else if("temp_id"in b)c=b.temp_id;else{do c=b.temp_id="temp_"+Math.floor(Math.random()*Math.pow(2,32));while(document.getElementById(c))}return c}var N={};function O(a,b){var c=P,d=$A(arguments).slice(1);1<arguments.length&&arguments[1].constructor instanceof P&&(c=d.shift().constructor);d.unshift(c);d.push({className:a});N[a]=new (r.apply(null,d))}function P(){}P.prototype.f="vsLabel";
P.prototype.create=function(a,b){for(var c,d=[],e=b.length,g=a.b.B(a.d),h=(new Element("DIV")).addClassName(this.f).addClassName("level_"+a.d).writeAttribute("vslabel").insert((new Element("DIV")).addClassName("pointer").insert((new Element("DIV")).addClassName("pointer-fill")));e--;)c=b[e],d.push([h.cloneNode(!0).insert(c.term).writeAttribute("id",M(a,c)),g*c.x,g*c.y,1,1]);return d};P.prototype.highlight=function(a){return a.addClassName("highlighted")};O("default");var Q=r(L);q=Q.prototype;q.p="thumbnail";q.f="vs-widget vsWidgetThumbnail";q.W=2;q.Sb=!1;
q.g=function(){this.element=(new Element("DIV")).addClassName(this.f);this.ia=(new Element("DIV",{title:"Click to toggle thumbnail visibility"})).addClassName("vs-widget vs-control vsThumbnailControl").observe("click",this.C);this.h=new Q.Sa;this.h.u(Ea,{relativeTo:this.a});this.h.ea("dblclick",this.h,this.h.M);J(this.h,"drop",this,this.Fc);J(this.h,"grab",this,this.bc);J(this.h,"dblclick",this,this.Tc);this.h.W=this.W;this.jb=new Da(this.h);this.jb.M=!1;this.G.push([this.ia,"dblclick",this.C],[this.ia,
"mousedown",this.C],[this.ia,"mousedown",this.toggle.bind(this)])};q.Eb=function(){this.Sb||this.jb.remove(this.a);this.align()};q.zc=function(){this.jb.add(this.a)};q.toggle=function(){L.prototype.toggle.call(this);this.ia.toggleClassName("minimized")};q.align=function(){this.h.O(ia(this.h.b,this.a.l(!0),this.h.d));return this};q.Tc=function(a,b){var c=this.a.focus(),d=u(b,c.width/this.h.width);a.shiftKey?c.Qa(d):c.Pa(d);this.align()};q.bc=f();
q.Fc=function(){this.Sb||this.a.O(ia(this.a.b,this.h.l(!0),this.a.d),this);this.a.focus()};q.H=function(a){(this.e||a).appendChild(this.element);(this.e||a).appendChild(this.ia);la(this.h,this.element)};Q.prototype.onResize=Q.prototype.X=function(){this.align()};Q.prototype.k=function(){this.h.load(this.a.b,null,this.a.l(!0),null,this)};Q.prototype.S=function(){this.h.hb(this)};Q.prototype.L=function(){this.S();this.h.L();this.h=null};Q.Sa=r(A);
Q.Sa.prototype.load=function(a,b,c,d,e){b=ja(a,this.j,this.o);return A.prototype.load.call(this,a,b,c,!0,e)};Q.Sa.prototype.Lb=function(){this.$=this.width;this.Z=this.height};var Ea=r(L);q=Ea.prototype;q.f="vsWidgetROI";q.p="roi";q.g=function(){this.element=(new Element("DIV")).addClassName(this.f);if(this.relativeTo){var a=this.relativeTo;this.relativeTo=a;J(a,"load",this,this.update);J(a,"zoom",this,this.update);this.update()}};
q.update=function(){var a=this.a,b=this.relativeTo,c=this.element,d=c.getStyle("borderTopWidth"),e=c.getStyle("borderLeftWidth"),g=a.width*b.j/b.width,b=a.height*b.o/b.height;c.setStyle({left:Math.round((a.j-g)/2-(0<e.indexOf("px")?parseInt(e,10):0))+"px",top:Math.round((a.o-b)/2-(0<d.indexOf("px")?parseInt(d,10):0))+"px",width:Math.round(g)+"px",height:Math.round(b)+"px"})};q.ma=function(){this.relativeTo&&this.relativeTo.ea(this)};q.k=function(){this.element.show();this.update()};q.S=function(){this.element.hide()};
q.Ec=Ea.prototype.X=function(){this.update()};var R=r(K);q=R.prototype;q.p="hyperlink";q.V=window.location.protocol+"//"+window.location.host+window.location.pathname;q.Ba=function(){return[this.V,"?s=",this.a.b.id,"&z=",this.a.d,"&c=",this.a.l(!0).toString()].join("")};q.update=function(){this.Ba()};q.k=R.prototype.Eb=R.prototype.X=function(){this.update()};var U=r(L);q=U.prototype;q.p="scalebar";q.f="vs-widget vsWidgetScalebar";q.Hb=100.74;q.Mc=10;q.za=[5,4,3,2,10,8,6,7,9];q.$a=[1,2,5,10,20,25,50,100,200,250,500];q.Va={pm:1E-9,nm:1E-6,"\u03bcm":0.001,mm:1,cm:10,m:1E3};q.error=(new Element("DIV")).addClassName("error").insert("Error making scale bar!");q.g=function(){this.element=(new Element("DIV")).addClassName(this.f);this.r&&(this.r=!1,this.toggle())};q.xb=function(a,b){return 160<=a&&240>=a&&40<b};q.update=function(){this.element.update(this.toElement())};
q.toElement=function(){var a,b,c,d,e=this.a.b.R(this.a.d);if(0==e)return this.error.cloneNode(!0);for(b=0;b<this.za.length;b++)for(a in this.Va)for(c=0;c<this.$a.length;c++)if(d=e*this.Hb*this.Va[a]*this.$a[c],this.xb(d*this.za[b],d))return U.create(e,a,this.Hb*this.Va[a],this.$a[c],this.za[b],this.Mc);return this.error.cloneNode(!0)};q.S=function(){this.element.update()};q.k=U.prototype.X=U.prototype.update;
U.create=function(a,b,c,d,e,g){d=d||1;e=e||1;var h,k=!0,l;c=aa(a*c*d*e,e);var m=g?aa(c(),g):null;l="Scale: %d%s @ %sx".D(d*e,b,Math.truncate(a,2));var n=(new Element("DIV",{title:l})).insert((new Element("TABLE",{cellPadding:0,cellSpacing:0})).insert((new Element("TBODY")).insert(a=new Element("TR")).insert(b=new Element("TR")).insert(h=new Element("TR")))).insert((new Element("SPAN")).addClassName("caption").update(l));if(g){for(l=0;l<g;l++,k=!k)a.insertCell(l).width=b.insertCell(l).width=m(),a.cells[l].className=
k?"light":"dark",b.cells[l].className=k?"dark":"light";h.insertCell(0);h.cells[0].innerHTML=d;h.cells[0].colSpan=g}for(l=0;l<e-(g?1:0);l++,k=!k)a.insertCell(l+g).width=b.insertCell(l+g).width=c(),a.cells[l+g].className=k?"light":"dark",b.cells[l+g].className=k?"dark":"light",h.insertCell(h.cells.length).innerHTML=d*(l+(g?2:1));n.style.minWidth=a.cells[l-1].width*l+10+"px";return n};var Fa=r(L);q=Fa.prototype;q.p="zoom";q.f="vs-widget vsWidgetZoomControl";q.sc=6;
q.g=function(){this.element=(new Element("FORM")).addClassName(this.f).insert(this.I=new Element("SELECT",{multiple:!1,disabled:!0})).insert(this.Aa=(new Element("BUTTON",{type:"button",title:"Click to fit slide in window",disabled:!0})).addClassName("vs-control").update("Fit"));this.G.push([this.I,"change",this.onchange.bind(this)],[this.element,"mousedown",this.C],[this.element,"dblclick",this.C],[this.Aa,"click",this.ic.bind(this)]);this.r&&(this.r=!1,this.toggle())};
q.toggle=function(){L.prototype.toggle.call(this);this.a.loaded()&&this.k()};q.ic=function(){var a=this.a,b=a.b,c=a.d,d=b.l(c);this.Aa.blur();F(a,z(b,a.j,a.o),d);a.d==c&&a.O(d)};q.onchange=function(){this.I.blur();F(this.a,this.I.selectedIndex,null,this)};q.k=function(){var a,b=this.a.b,c=b.i.length;this.I.size=this.r?1:Math.F(c,0,this.sc);this.I.disabled=this.Aa.disabled=!(1<c);for(a=this.I.length=0;a<c;a++)this.I.options[a]=new Option(Math.truncate(b.R(a),1)+"x",a,!1,a==this.a.d)};
q.S=function(){this.I.disabled=!0;this.Aa.disabled=!0};q.X=function(){this.I.selectedIndex=this.a.d};q.ma=function(){this.I=null};var V=r(K);q=V.prototype;q.p="iterator";q.name="";q.description="";q.g=function(){this.pa(this.Ka||{});delete this.Ka};q.position=function(a){return(this.t||[]).indexOf(a||this.a.b)};q.go=function(a){var b=0<=a&&a<this.t.length&&a!=this.position();b&&this.ba(a);return b};q.ba=function(a,b,c,d){this.a.load(this.t[a],b,c,d);return this};q.pa=function(a){return Object.extend(this,s.Ra({id:null,name:"",description:"",t:[]},a))};q.first=function(){return this.go(0)};
q.last=function(){return this.go(this.t.length-1)};V.Da=function(){function a(){var a=E;return a?a.n.iterator:void 0}return new v({"Left arrow: 37":function(b,c){var d=a();if(d)if(c)c==w.ra&&(b.stop(),d.first());else{var e=d.position();-1<e&&d.go(e+-1)}},"Right arrow: 39":function(b,c){var d=a();if(d)if(c)c==w.ra&&(b.stop(),d.last());else{var e=d.position();-1<e&&d.go(e+1)}}})}();var W=r(V);W.prototype.g=function(){V.prototype.g.call(this);this.va=this.va||{}};W.prototype.position=function(a){return this.t.indexOf(a||this.a.b&&this.a.b.id)};W.prototype.ba=function(a,b,c,d){ya(this.a,this.t[a],b,c,d,this.va)};var X=r(L);X.prototype.p="slidelabel";X.prototype.f="vs-widget vsSlideLabel";
X.prototype.g=function(){this.element=(new Element("DIV")).addClassName(this.f).observe("mousedown",this.C).observe("dblclick",this.C).insert((new Element("DIV")).addClassName("vs-control title").insert(this.Nb=new Element("A",{title:"Click to toggle slide description"}))).insert(this.Jc=(new Element("DIV")).addClassName("description"));this.G.push(s.oc?[this.element,"touchstart",this.toggle.bindAsEventListener(this)]:[this.Nb,"click",this.toggle.bindAsEventListener(this)]);this.r&&(this.r=!1,this.toggle())};
X.prototype.k=function(a){this.Nb.update(a.title||'<i style="font-size:smaller">(Untitled slide)</i>');this.Jc.update(a.description||'<i style="font-size:smaller">(No description)</i>');L.prototype.k.call(this)};var Ga=r(K);q=Ga.prototype;q.p="labels";q.url="labels.ajax.php";q.ec="centered";q.request=null;q.v=null;q.aa=null;q.Wa=0;q.Ic=0;q.kc=0;q.vc=0;q.wc=0;q.g=function(){this.ga=this.J.bind(this);this.fa=this.N.bind(this);this.ha=this.Y.bind(this);this.v=[];this.aa=[]};function Ha(a){return a.element().ancestors().find(function(a){return a.readAttribute("vslabel")})}
q.ma=function(){this.request&&this.request.cancel();this.remove(this.v);var a=this.a;a.ea("down",a,a.Xa).ea("dblclick",a,a.M);a.A.down.unshift([a,a.Xa]);a.A.dblclick.unshift([a,a.M])};q.add=function(a){this.v=this.v.concat(a=[].concat(a));Ia(this,a,this.Wa);return this};
q.remove=function(a){a=[].concat(a);this.v=Array.prototype.without.apply(this.v,a);var b=this.a,c=a,d,e=c.length;a=[];if(this.a)for(;e--;)(d=document.getElementById(M(this.a,c[e])))&&a.push(d);d=b.La;c=d.length;for(a=[].concat(a);c--;)for(e=a.length;e--;)if(d[c][0]==a[e]){d.splice(c,1);a.splice(e,1);break}b.refresh();return this};
function Ia(a,b,c){for(var d={},e=b.length,g;e--;)b[e].z&c&&(g=b[e].constructor||a.ec||"default",g in d||(d[g]=[]),d[g].push(b[e]));for(g in d)if(g in N)for(b=N[g].create(a.a,d[g]),e=b.length;e--;)a.a.ub.apply(a.a,b[e]);qa(a.a);return a}
q.highlight=function(a){for(var b,c=this.aa.length;c--;)(b=document.getElementById(M(this.a,this.aa[c])))&&b.removeClassName("highlighted");this.aa=[];a=this.aa=[].concat(a||[]);for(c=a.length;c--;)(b=document.getElementById(M(this.a,a[c])))&&N[a[c].constructor].highlight(b);return this};
q.O=function(a,b,c,d){var e=this.a,g=u([a.x+this.vc,a.y+this.wc],e.B());!b||a.z&Math.pow(2,this.a.d)?c?xa(e,[(e.j>>1)-g[0],(e.o>>1)-g[1]],d):e.O(g):F(e,Math.log(1<<Math.floor(Math.log(a.z)/Math.log(2)))/Math.log(2),g);return this};q.k=function(){this.request=new Ajax.Request(this.url,{method:"get",parameters:{slide_id:this.a.b.id},onSuccess:this.ga,onFailure:this.fa,onTimeout:this.ha})};q.S=function(){this.request&&this.request.cancel();this.v.length=0};
q.X=function(){this.Wa=(Math.pow(2,this.a.d)|this.Ic)&~this.kc;Ia(this,this.v,this.Wa).highlight(this.aa)};q.J=function(a){var b;try{b=eval("("+a.responseText+")")}catch(c){console.error("vs.widget.Labels.ajaxException(): %s".D(c.message))}this.v=b;this.X()};q.N=f();q.Y=f();q.search=function(a,b){b=b||this.v;for(var c=[],d=b.length;d--;)a(b[d])&&c.push(b[d]);return c};function Ja(a,b,c,d){return a.search(function(a){return a[b]==c},d)}
function Ka(a,b){var c,d;c=b.id||"";c=(d=c.match(/^vs\d+_(\d+)$/)||c.match(/^(temp_\d+)$/))?d[1]:d;d=Ja(a,"id",c,void 0);d.length||(d=Ja(a,"temp_id",c,void 0));return d.length?d[0]:void 0}function La(a,b){var c=b.toLowerCase();return a.search(function(a){return~(a.term||"").toLowerCase().indexOf(c)||a.definition&&~a.definition.stripTags().toLowerCase().indexOf(c)},void 0)}function Ma(a,b,c){return a.search(function(a){return a.z&b},c)}q.sort=function(a,b){return(b||this.v).sort(a)};
function Na(a,b){return a.sort(function(a,b){return a.term<b.term?-1:a.term>b.term?1:0},b)}function Oa(a,b,c){var d=b[0],e=b[1];return a.sort(function(a,b){var c=b.x-d,l=b.y-e,m=a.x-d,n=a.y-e;return m*m+n*n-c*c-l*l},c)};x.prototype.V="tile.jpeg.php";x.prototype.bgColor="#FFF";x.prototype.bb=40;x.prototype.url=function(a,b,c,d){return[this.V,"?s=",this.id,"&z=",c,"&i=",d].join("")};A.prototype.Ab="slide.ajax.php";A.prototype.N=function(){new Pa};A.prototype.Y=function(){new Pa};
O("default",{f:"",jc:function(a){return(new Element("DIV")).addClassName("vsLabel "+this.className).addClassName("level_"+a.d).writeAttribute("vslabel").insert((new Element("DIV")).addClassName("label").insert((new Element("DIV")).addClassName("content"))).insert((new Element("DIV")).addClassName("pointer").insert((new Element("DIV")).addClassName("pointer-fill")))},update:function(a,b){a.firstChild.firstChild.insert(b.annotation&&!b.term?(new Element("DIV")).addClassName("annotation-icon"):b.term);
return a},create:function(a,b){for(var c,d,e=[],g=b.length,h=a.b.B(a.d),k=this.jc(a),l=Math.pow(2,a.d);g--;)c=b[g],d=k.cloneNode(!0).writeAttribute("id",M(a,c)),c.z&l||d.addClassName(c.z<l?"below":"above"),e.push([this.update(d,c),Math.round(h*c.x),Math.round(h*c.y),1,1]);return this.Cb(a,e)},Cb:function(a,b){return b}});
O("centered",N["default"],{wb:!0,Db:!0,Cb:function(a,b){var c,d,e=a.createElement().remove().setStyle({visibility:"hidden"});for(c=b.length;c--;)e.appendChild(b[c][0]);a.e.appendChild(e);for(c=b.length;c--;)d=b[c][0],this.wb&&(d.firstChild.style.marginLeft=-(d.firstChild.offsetWidth>>1)+"px"),this.Db&&(d.firstChild.style.marginTop=-(d.firstChild.offsetHeight>>1)+"px");e.remove();return b}});O("top-center",N.centered,{Db:!1});O("bottom-center",N["top-center"]);O("left-middle",N.centered,{wb:!1});
O("right-middle",N["left-middle"]);O("top-left2",N["default"]);O("top-right2",N["default"]);O("bottom-left2",N["default"]);O("bottom-right2",N["default"]);O("left-top",N["default"]);O("right-top",N["default"]);var Y=r(U);Y.prototype.p="ruler";Y.prototype.f="vs-widget vsWidgetRuler";Y.prototype.za=[10,8,9,7,6,5,4,3,2];Y.prototype.xb=function(a,b){return a>=0.8*this.a.j&&a<=this.a.j&&40<b};Y.prototype.onResize=U.prototype.update;var Qa=r(L,R.prototype,{f:"vs-widget zfHyperlink",g:function(){function a(){this.select()}this.element=(new Element("FORM")).addClassName(this.f).insert((new Element("P")).insert("To this slide")).insert((new Element("DIV")).addClassName("input-100-wrapper").insert((new Element("INPUT",{type:"text",readonly:!0})).observe("click",a))).insert((new Element("P")).insert("To this view")).insert((new Element("DIV")).addClassName("input-100-wrapper").insert((new Element("INPUT",{type:"text",readonly:!0})).observe("click",
a)))},update:function(){var a=this.element.select("INPUT"),b=this.a;a[0].value=this.Ba(b.b.id);a[1].value=this.Ba(b.b.id,b.d,b.l(!0))},k:function(a,b,c){R.prototype.k.apply(this,arguments)},Ba:function(a,b,c){var d=this.a.n.iterator,e=window.location;a=["http://",e.host,e.pathname,"?s=",a];d&&d.id&&a.push("&atlas=",d.id);null!=b&&a.push("&z=",b);c&&a.push("&c=",c.join());return a.join("")}});var Ra=r(Q,{g:function(){function a(a,b){a&&("finished"!=a.state&&(b=0),a.cancel());return b}Q.prototype.g.call(this);var b,c,d=!1,e=this.h,g={width:"100px",height:"67px",borderWidth:"2px"},h={width:"350px",height:"250px",borderWidth:"1px"},k={duration:0.2,afterSetup:function(){c=e.l()},afterUpdate:function(){c&&(na(e).O(c),e.n.roi.update())}},l=function(){d=!1;e.w||(b=new Effect.Morph(this,Object.extend({style:g,delay:a(b,0.6)},k)))}.bind(this.element),m=function(){d=!0;e.w||(b=new Effect.Morph(this,
Object.extend({style:h,delay:a(b,0.2)},k)))}.bind(this.element);J(e,"drop",this,function(){d||l(null)});this.h.load=function(a,b,c,d,e){b=ja(a,parseInt(h.width,10),parseInt(h.height,10));return A.prototype.load.call(this,a,b,c,!0,e)};J(this.a,"grab",this,function(){b&&b.cancel();this.element.setStyle(g);na(this.h);this.h.n.roi.update();this.align()});this.element.observe("mouseleave",l).observe("mouseenter",m);this.element.setStyle(g)}});var Sa=r(X);Sa.prototype.f="vs-widget vsSlideLabel";
Sa.prototype.k=function(a){var b=this.a.n.iterator,c=b?b.position():-1,d=this.element.update(),e=a.title,g=(new Element("H1")).addClassName("title");d.insert(e?g.insert(e):g.addClassName("untitled").insert("(Untitled slide)"));b&&-1<c&&d.insert((new Element("DIV")).addClassName("series").insert((new Element("A",{href:"/search.php?atlas=%d&thumbnails=1#results".D(b.id)})).observe("click",function(){this.blur()}).insert(b.name)).insert((new Element("DIV")).insert("Slide %d of %d".D(c+1,b.t.length))));
a.description&&d.insert((new Element("DIV")).addClassName("description").insert(a.description));a.source&&d.insert((new Element("CITE")).insert(a.source))};Sa.prototype.S=function(){this.element.update((new Element("P")).addClassName("no-content").insert("No slide"))};var Z=r(W);q=Z.prototype;q.oa="";q.g=function(){W.prototype.g.call(this);this.va.onSuccess=this.Rc.bind(this)};q.Rc=function(a){var b;try{b=new x(eval("("+a.responseText+")")),this.ba(b)}catch(c){console.error("[zfatlas.widget.Iterator]; ajaxSuccess(): error evaling response: %s".D(c.message))}};
q.ba=function(a,b,c,d){if("number"==typeof a)ya(this.a,this.t[a],b,c,d,this.va);else{var e=this.a.loaded(),g=-1<this.t.indexOf(a.id),e=g&&e&&-1<this.t.indexOf(this.a.b.id),h=this.a.j,k=this.a.o;y(a,b)||(e?b=ka(a,this.a.b.R(this.a.d)):g&&(b=z(a,h,k)));if(!c)if(e)switch(g=this.a.l(!0),c=[g[0]*a.i[b][0]/this.a.b.i[this.a.d][0],g[1]*a.i[b][1]/this.a.b.i[this.a.d][1]],d=e,this.oa.toLowerCase()){case "coronal":c[0]=g[0];break;case "transverse":c[1]=g[1];break;case "sagittal":case "saggital":c=g}else if(g)switch(y(a,
b)||(b=z(a,h,k),b=-1==b?a.i.length-1:b),d=e,c=a.l(b),this.oa.toLowerCase()){case "coronal":c[0]=Math.min(h>>1,c[0]);break;case "transverse":c[1]=Math.min(k>>1,c[1]);break;default:c=[Math.min(h>>1,c[0]),Math.min(k>>1,c[1])]}this.a.load(a,b,c,d,this)}};q.pa=function(a){Object.extend(W.prototype.pa.apply(this,arguments),{oa:a.oa||""})};var Ta=r(Z);q=Ta.prototype;q.f="vs-widget zf-widget vs-widget-slider";q.align="top-left2";q.url="thumbnails/preview/%010d.jpg";q.yb=-1;
q.g=function(){Z.prototype.g.call(this);this.dc=[];this.element=(new Element("DIV")).addClassName(this.f).addClassName(this.align).insert(this.gb=(new Element("DIV")).addClassName("slider-track").insert((new Element("DIV")).addClassName("current-pointer")).insert(this.db=(new Element("DIV")).addClassName("slider").hide().insert((new Element("DIV")).addClassName("pointer").insert((new Element("DIV")).addClassName("pointer-fill"))).insert(this.content=(new Element("DIV")).addClassName("preview").insert(new Element("IMG")).insert(new Element("P")))));
J(this.a,"load",null,L.prototype.k.bind(this));this.G.push([this.element,"mouseout",this.Bc.bindAsEventListener(this)],[this.element,"mouseover",this.Cc.bindAsEventListener(this)],[this.element,"mousemove",this.Ac.bindAsEventListener(this)],[this.element,"mousedown",this.Fa.bindAsEventListener(this)],[this.element,"dblclick",this.C.bind(this)])};q.Cc=function(){this.db.show()};q.Bc=function(){this.db.hide()};
function Ua(a,b){var c=a.gb;return Math.F(b.clientX-c.cumulativeOffset().left,0,c.offsetWidth)}function Ya(a,b){var c=a.gb.offsetWidth,d=a.t.length-1;return Math.floor(d*(b-c/(2*d))/c)+1}q.Ac=function(a){a=Ua(this,a);var b=Ya(this,a);this.db.style.left=a+"px";b!=this.yb&&(this.content.select("P")[0].update("%d / %d".D(b+1,this.t.length)),this.content.select("IMG")[0].replace(Za(this,a)),this.yb=b)};function $a(a,b){a.element.select(".current-pointer")[0].style.left=b+"px"}
q.Fa=function(a){var b=Ua(this,a);a.stop();$a(this,b);this.ba(Ya(this,b))};function Za(a,b){var c=a.dc,d=Ya(a,b);c[d]||(c[d]=new Element("IMG",{src:a.url.D(a.t[d])}));return c[d]}q.k=function(){L.prototype.k.apply(this,arguments);var a=this.t.length-1,b=this.position(),c=this.gb.offsetWidth;$a(this,b?Math.floor(c*b/a):0)};q.H=L.prototype.H;q.C=L.prototype.C;r(Z,{f:"vs-widget zf-widget-series-navigator",V:"/atlas.ajax.php",request:null,list:null,url:function(a){return[this.V,"?atlas_list=",a].join("")},g:function(){this.element=(new Element("DIV")).addClassName(this.f);this.G.push([this.element,"click",this.Ua.bindAsEventListener(this)]);this.Yb=this.cc.bind(this);this.ga=this.J.bind(this);this.fa=this.N.bind(this);this.ha=this.Y.bind(this);J(this.a,"load",null,this.Kb.bind(this));Z.prototype.g.call(this)},update:function(a){this.element.update((new Element("P")).addClassName("no-content").insert(a))},
pa:function(a){W.prototype.pa.call(this,a);this.update("Loading...");this.id?new Ajax.Request(this.url(this.id),{onCreate:this.Yb,onFailure:this.fa,onTimeout:this.ha,onSuccess:this.ga}):this.N();return this},H:L.prototype.H,Kb:function(){var a,b=this.position();this.element.select("LI.active").invoke("removeClassName","active");-1<b?(a=this.element.select("LI").find(function(a){return a.value==b+1}))&&a.addClassName("active").Jb(Element.Vb):this.N()},Ua:function(a){var b=a.findElement("A");if(b)return a.stop(),
b.blur(),a=b.up("LI"),a.hasClassName("active")||this.ba(a.readAttribute("value")-1),!1},Gc:function(){var a,b,c,d,e=this.list,g=new Element("OL");a=document;var h=a.createElement("LI"),k=a.createElement("A"),l=a.createDocumentFragment();this.element.update((new Element("H1")).addClassName("title").insert(this.name));this.description&&this.element.insert((new Element("DIV")).addClassName("description").insert(this.description));a=0;for(b=e.length;a<b;a++)d=k.cloneNode(!1),d.href="/view.php?s="+e[a].id+
"&atlas="+this.id,d.innerHTML=e[a].title||"Untitled slide",c=h.cloneNode(!1),c.value=a+1,c.appendChild(d),l.appendChild(c);g.appendChild(l);this.element.insert(g);this.a.loaded()&&this.Kb();return this},J:function(a){var b;try{b=eval("("+a.responseText+")")}catch(c){console.log("[zfatlas.widget.SeriesNavigator]:  ajaxSuccess(); error eval'ing response; %s",c.message)}this.list=b||[];this.Gc()},cc:function(){this.update("Loading . . .")},N:function(){this.update("No other slides in this series.")},
Y:function(){this.update("Server timed out.")}});var ab=r(L,Ga.prototype,{f:"vs-widget zf-widget-label-search",la:"",bd:2,Da:{"Esc: 27":function(a){var b=this.element.select("INPUT").first();a.stop();b.value?this.Ta().ka():b.blur()}},ja:{startcolor:"#99ccff",endcolor:"#eeeeee",duration:2},g:function(){var a,b,c={},d=new Element("INPUT",{type:"text",placeholder:"Search labels"}),e=(new Element("DIV")).addClassName("terms"),g=(new Element("DIV",{title:"Clear search [Esc]"})).addClassName("control"),h=!1;for(a in this.Da)c[a]=this.Da[a].bind(this);
b=new ha(new v(c));this.element=(new Element("DIV")).addClassName(this.f).insert((new Element("DIV")).addClassName("input-100-wrapper").insert(d).insert(g)).insert(e);this.G.push([d,"focus",function(){h||(h=!0,w.cb(b))}],[d,"blur",function(){h&&(h=!1,w.Gb())}],[d,"keyup",ba(function(){var a=d.value;a!==this.la&&this.ka(La(this,this.la=a||""))}.bindAsEventListener(this))],[e,"click",function(a){a=a.findElement("DT");var b;a&&(a=Ja(this,"term",a.innerHTML.stripTags()),a.length&&(b=Ma(this,Math.pow(2,
this.a.d),a),b.length&&(a=b),this.O(Oa(this,this.a.l(!0),a)[0],!0),this.a.n.thumbnail&&this.a.n.thumbnail.align()))}.bindAsEventListener(this)],[g,"click",function(a){a.stop();this.Ta().ka()}.bindAsEventListener(this)]);Ga.prototype.g.call(this)},Ta:function(){this.element.select("INPUT").first().value=this.la="";return this},ab:function(a){a=Ha(a);var b;a&&(b=Ka(this,a))&&(this.Ta().ka(),(a=this.element.select("DT").find(function(a){return a.innerHTML==b.term}))&&(a=a.up("DL"))&&a.Jb(Element.pb,
!0).highlight(this.ja))},J:function(a,b){Ga.prototype.J.apply(this,arguments);this.ka()},ka:function(a){var b=this.element.select("DIV.terms").first(),c,d=[];a=a||this.v||[];a=Na(this,da(a.concat(),function(a,b){return a.term_id-b.term_id}));if(this.v.length)if(a.length){for(var e=0,g=a.length;e<g;e++)c=a[e],d.push("<DL><DT>",c.term,"</DT>"),c.definition&&d.push("<DD>",c.definition,"</DD>"),d.push("</DL>");b.update(this.la?ca(d.join(""),this.la.split(/\s+/)):d.join(""))}else b.update((new Element("P")).addClassName("no-content").insert("No matches"));
else b.update((new Element("P")).addClassName("no-content").insert("No labels present on this slide"));return this}});(function(){function a(){g.update(this);this.onload=null}function b(b){var c=b.findElement("A"),d=document.body,m=document.createElement("IMG"),c=(c=c.href.match(/[?&]s=(\d+)/))?"thumbnails/preview/%010d.jpg".D(c[1]):!1,n=b.pointerX();b=b.pointerY();var t=document.viewport.getDimensions(),p={left:"auto",top:"auto",right:"auto",bottom:"auto"};n>d.scrollLeft+t.width/2?p.right=d.offsetWidth-n+"px":p.left=n+"px";b>d.scrollTop+t.height/2?p.bottom=d.offsetHeight-b+"px":p.top=b+"px";!1!==c&&(g.setStyle(p).update(e).show(),
m.onload=a,m.src=c)}function c(){g.hide()}function d(a){var d=b,e=c;(0,Prototype.K)(a);return a.observe("mouseenter",d).observe("mouseleave",e)}var e=new Element("IMG",{src:"images/loading-preview-im.gif"}),g=(new Element("DIV")).addClassName("vs-hover-preview").insert(e);return function(a,b){$(document.body).insert(g.hide());a.select("A").findAll(function(a){return b.test(a.href)}).map(d)}})();function bb(){var a,b,c,d={duration:0.25,queue:"end"};this.vb?(c=function(c){b.stopObserving("click",arguments.callee);$("blackout").fade(d).update();w.Gb();b=a=null},a=(new Element("DIV")).addClassName("close-bar").insert(b=(new Element("BUTTON",{type:"button"})).insert("Dismiss").observe("click",c)),w.cb(new ha(new v({"Esc: 27":c})))):w.stop();$("blackout").appear(d).update(this.toElement().insert({top:a}))}bb.prototype.vb=!0;bb.prototype.toElement=function(){return(new Element("DIV")).addClassName("blackout-content")};
var cb=r(bb);cb.prototype.vb=!1;cb.prototype.toElement=function(){return(new Element("DIV")).addClassName("blackout-content").insert('\t\t<div class="shadow-box"><h1>Slide Not Found</h1> \t\t\t<p>Sorry, but we couldn\'t find that slide.  Maybe you\'d like to go somewhere else?</p> \t\t\t<ul> \t\t\t\t<li><a href="index.php">Zebrafish Atlas home page</a></li> \t\t\t\t<li><a href="progress.php">Zebrafish Atlas overview chart</a></li> \t\t\t\t<li><a href="search.php">Search slides</a></li> \t\t\t\t<li><a href="contact.php">Contact us</a></li> \t\t\t</ul> \t\t</div> \t')};
var Pa=r(bb);Pa.prototype.toElement=function(){return(new Element("DIV")).addClassName("blackout-content").insert('\t\t<div class="shadow-box"><h1>Server Unavailable</h1> \t\t<p>Sorry, but the server is taking too long to respond.  This may be a temporary condition; you can try again.</p> \t')};var fb=function(){function a(){var a=D[0];return a?a.n:void 0}function b(){var b=a();return b?b.panel:void 0}function c(c,d){db(b(),a()[c],d)}function d(){a().labels.element.select("INPUT").first().focus()}function e(a){return a&(w.ra|w.ob)}return new v({"spacebar: 32":function(a){a.stop();b().toggle()},"Esc: 27":function(){eb(b()).hide()},"a: 65":function(a,b){e(b)||c("slidelabel")},"k: 75":function(a,b){e(b)||c("hyperlink")},"s: 83":function(a,b){e(b)||c("iterator")},"l: 76":function(a,b){e(b)||
c("labels")},"f: 70":function(a,b){e(b)||(a.stop(),c("labels",d))},"h,?: 72 191":function(a,b){e(b)||c("help")},"R: 82":function(b,c){var d=a();d&&c==w.sa&&("ruler"in d?d.ruler.L():D[0].u(Y))}})}();var gb=r(L);q=gb.prototype;q.f="zf-ui-sliding-panel";q.na="right";q.p="panel";q.ja={duration:0.2,transition:Effect.Transitions.sinoidal,queue:{position:"end",scope:"sliding-panel"}};
q.g=function(){this.n=[];this.element=(new Element("DIV")).addClassName(this.f).addClassName(this.na).observe("dblclick",this.C).observe("mousedown",this.C).insert((new Element("DIV",{title:"Click to toggle panel visibility [spacebar]"})).addClassName("control").observe("click",this.toggle.bind(this))).insert((new Element("DIV")).addClassName("content-wrapper").insert(this.content=(new Element("DIV")).addClassName("content")));this.element.observe("click",function(a){var b=a.findElement("A");b&&(a.stop(),
window.open(b.href,"zfatlas"))})};q.Fb=function(){this.scrollTop=this.scrollLeft=0};q.H=function(a){L.prototype.H.apply(this,arguments);a.observe("scroll",this.Fb)};q.Ea=function(a){L.prototype.Ea.apply(this,arguments);a.stopObserving("scroll",this.Fb)};
q.u=function(a,b,c,d,e){var g,h=Prototype.emptyFunction,k=(new Element("DIV")).addClassName("wrapper").setStyle({display:"none"}),l=(new Element("DIV")).addClassName("zf-ui-panel-widget");try{g=new b(this.a,Object.extend({e:k},Object.clone(c)))}catch(m){console.error("[zfatlas.ui.SlidingPanel] addWidget(); failed to create widget: %s",m.message)}g&&(this.n.push({Sc:g,Dc:d?d.bind(g,this):h,cd:e?e.bind(g,this):h}),this.content.insert(l.insert((new Element("DIV")).addClassName("title").insert(a).insert((new Element("DIV")).addClassName("status")).observe("click",
this.Ua.bind(this))).insert(k)));return this};function hb(a,b){var c=a.ua;c&&c.removeClassName("active");b&&b.addClassName("active");return a.ua=b}function ib(a){return(a=a&&a.up(".zf-ui-panel-widget"))?a.select(".wrapper").first():a}function eb(a){var b=a.ua;b&&(new Effect.BlindUp(b,a.ja),hb(a));return a}q.Ua=function(a){a=ib(Event.findElement(a));a==this.ua?eb(this):db(this,a)};function jb(a,b){return a.n.find(function(a){return a.Sc.e==b})}
function db(a,b,c){b=ib(b instanceof Element?b:b.element);var d=a.ua,e=jb(a,b),g=[],h={sync:!0};a.show();if(b&&b!=d)return d&&g.push(new Effect.BlindUp(d,h)),g.push(new Effect.BlindDown(hb(a,b),Object.extend({afterFinish:e?c||e.Dc:Prototype.emptyFunction},h))),new Effect.Parallel(g,a.ja),a;c&&c()}
q.toggle=function(){var a="top"==this.na||"bottom"==this.na?"height":"width",a=(this.r=!this.r)?"-"+this.element.getStyle(a):"0px",b={};this.r&&document.activeElement&&document.activeElement.descendantOf(this.element)&&document.activeElement.blur();Object.extend(b,this.ja);b.style=this.na+":"+a;new Effect.Morph(this.element,b);return this};var kb=r(L,{p:"help",f:"vs-widget",g:function(){this.element=(new Element("DIV")).addClassName(this.f).insert('<H2>Movement</H2><P>Moving around in a slide is fairly intuitive.  Just hold down the left mouse button and drag the slide around.</P><HR><H2>Zoom</H2><P>To change the magnification, use either the zoom control in the upper-left corner or double-click with your mouse (shift + double-click zooms out).</P><HR><H2>Navigation</H2><P>If a slide is a member of a series, you can navigate to other slides in the series using either using the keys listed below or by clicking on a title in the list under the &quot;Other slides in this series&quot; panel.</P><HR><H2>Keys</H2><P>Frequent users might find these keyboard shortcuts helpful.</P><TABLE><TR><TD>-</TD><TD>Zoom out one level</TD></TR><TR><TD>+</TD><TD>Zoom in one level</TD></TR><TR><TD>(shift) +</TD><TD>Zoom in to highest resolution</TD></TR><TR><TD>(shift) -</TD><TD>Fit slide in window (if possible)</TD></TR><TR><TD>left arrow</TD><TD>Next slide in a series</TD></TR><TR><TD>right arrow</TD><TD>Previous slide in a series</TD></TR><TR><TD>(ctrl) left arrow</TD><TD>First slide in a series</TD></TR><TR><TD>(ctrl) right arrow</TD><TD>Last slide in a series</TD></TR><TR><TD>(spacebar)</TD><TD>Toggle this sliding panel</TD></TR><TR><TD>a</TD><TD>Open &quot;About this slide&quot;</TD></TR><TR><TD>k</TD><TD>Open &quot;Link to this slide&quot;</TD></TR><TR><TD>s</TD><TD>Open &quot;Other slides in this series&quot;</TD></TR><TR><TD>l</TD><TD>Open &quot;Labels on this slide&quot;</TD></TR><TR><TD>h or ?</TD><TD>Display this help</TD></TR></TABLE><HR><P>Please <A href="/contact.php">contact us</A> with any comments or issues you have.</P>')}});window.zfatlas={};
window.zfatlas.FullScreenViewer=function(a,b,c){var d=new A;Event.observe(document,"dom:loaded",function(){var e,g;g=$("zfSliderContainer");var h=s.Ha.c,h=h&&h.match(/^\d+,\d+$/)?h.split(","):null;la(d,$(a)).u(Fa,{e:g}).u(U).u(Z).u(Z,{Ka:c}).u(Ta,{e:g,p:"slider",Ka:c}).u(gb,{na:"right"}).focus();e=db(d.n.panel.u("<u>A</u>bout this slide",Sa).u("Lin<u>k</u> to this slide",Qa).u("<u>L</u>abels on this slide",ab,{J:function(){ab.prototype.J.apply(this,arguments);var a=this,b=this.v.length,a=(a=(a=(a=
a instanceof Element?a:a.element)&&a.up(".zf-ui-panel-widget"))&&a.select(".title").first())&&a.select(".status").first();null!==b&&a.update(b)},ab:function(a){Ha(a)&&db(e,this,ab.prototype.ab.bind(this,a))}}).u("Viewer <u>h</u>elp",kb),d.n.slidelabel);d.u(Ra,{e:e.element});Event.observe(window,"resize",Ba);w.start();Ajax.Request.addMethods(ga);Ajax.Request.addMethods(fa);Ajax.Responders.register(ea);Aa.Ca.unshift(V.Da);Aa.Ca.unshift(fb);g=d.n.iterator;0<b.id?d.load(new x(b),s.Ha.z,h,!0):c.slides&&
c.slides.length?g.first():new cb});return d};})();
